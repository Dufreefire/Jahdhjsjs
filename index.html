<!DOCTYPE html>              
<html lang="vi">              
<head>              
    <meta charset="UTF-8">              
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">              
    <title>Tool T√†i X·ªâu MD5 - Premium Edition</title>              
    <script src="https://cdn.tailwindcss.com"></script>              
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>              
    <style>              
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;700;900&display=swap');              
        :root { --main: #00f2ff; --sub: #7000ff; --dark: #020205; }              
                
        * { -webkit-user-select: none; user-select: none; box-sizing: border-box; outline: none !important; -webkit-tap-highlight-color: transparent; }              
        input, textarea { -webkit-user-select: auto !important; user-select: auto !important; pointer-events: auto !important; }        
        
        body { background-color: var(--dark); color: white; font-family: 'Lexend', sans-serif; overflow: hidden; height: 100vh; margin: 0; }              
                      
        #bg-canvas { position: fixed; inset: 0; z-index: -1; }              
        .laser-beam { position: absolute; width: 2px; height: 100%; background: linear-gradient(to bottom, transparent, var(--main), transparent); opacity: 0.1; filter: blur(1px); animation: laser-move 8s linear infinite; }              
        @keyframes laser-move { 0% { transform: translateX(-100vw) rotate(45deg); } 100% { transform: translateX(200vw) rotate(45deg); } }              
              
        .glass-card { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(0, 242, 255, 0.15); backdrop-filter: blur(20px); border-radius: 30px; }              
        .btn-main { background: linear-gradient(135deg, var(--main) 0%, var(--sub) 100%); color: white; font-weight: 800; cursor: pointer; transition: 0.3s; }              
        .btn-main:active { transform: scale(0.98); opacity: 0.9; }
        .cyber-input { background: rgba(0, 0, 0, 0.6) !important; border: 1px solid rgba(255, 255, 255, 0.1) !important; color: var(--main) !important; border-radius: 15px !important; text-align: center; }              
              
        .pkg-item { position: relative; overflow: hidden; border: 1px solid rgba(255,255,255,0.05); transition: 0.3s; }              
        .pkg-item:active { transform: scale(0.95); }              
        .pkg-silver { border-left: 4px solid #00f2ff; animation: pulse-cyan 2s infinite; }              
        .pkg-gold { border-left: 4px solid #fbbf24; animation: pulse-gold 2s infinite; }              
        .pkg-diamond { border-left: 4px solid #f472b6; animation: pulse-pink 2s infinite; }              
              
        @keyframes pulse-cyan { 0% { box-shadow: 0 0 0 0 rgba(0,242,255,0.2); } 70% { box-shadow: 0 0 0 10px rgba(0,242,255,0); } 100% { box-shadow: 0 0 0 0 rgba(0,242,255,0); } }              
              
        .nav-bar { position: fixed; bottom: 0; left: 0; right: 0; height: 75px; background: rgba(10,10,20,0.95); border-top: 1px solid rgba(0,242,255,0.2); backdrop-filter: blur(20px); display: flex; justify-content: space-around; align-items: center; z-index: 999; }              
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #555; cursor: pointer; transition: 0.3s; width: 60px; }              
        .nav-item.active { color: var(--main); }              
        .nav-item svg { width: 22px; height: 22px; }              
        .nav-item span { font-size: 8px; font-weight: 900; text-transform: uppercase; margin-top: 4px; }              
        .nav-center { position: relative; top: -20px; width: 65px; height: 65px; background: linear-gradient(135deg, var(--main), var(--sub)); border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px rgba(0, 242, 255, 0.5); border: 4px solid var(--dark); }              
                      
        .success-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 10000; display: none; align-items: center; justify-content: center; flex-direction: column; }              
        .loader-bar { width: 200px; height: 4px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; margin-top: 20px; }              
        .loader-progress { width: 0%; height: 100%; background: var(--main); box-shadow: 0 0 10px var(--main); }              
              
        .avatar-img { width: 45px; height: 45px; border-radius: 12px; border: 2px solid var(--main); object-fit: cover; }              
        #fireworks { position: fixed; inset: 0; pointer-events: none; z-index: 10001; }              
              
        .session-log { background: rgba(255,255,255,0.03); border-radius: 15px; padding: 10px; font-size: 9px; border: 1px solid rgba(255,255,255,0.05); margin-top: 10px; }              
        .session-item { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid rgba(255,255,255,0.02); }              
          
        .transition-overlay { position: fixed; inset: 0; background: radial-gradient(circle, #0a0a14 0%, #020205 100%); z-index: 11000; display: none; align-items: center; justify-content: center; flex-direction: column; }            
        .radar-scan { width: 120px; height: 120px; border: 2px solid var(--main); border-radius: 50%; position: relative; overflow: hidden; box-shadow: 0 0 20px rgba(0, 242, 255, 0.2); }            
        .radar-scan::after { content: ""; position: absolute; inset: 0; background: conic-gradient(from 0deg, transparent 80%, var(--main)); animation: rotate-radar 1.2s linear infinite; }            
        @keyframes rotate-radar { to { transform: rotate(360deg); } }            
        .matrix-text { font-family: monospace; font-size: 10px; color: var(--main); margin-top: 25px; letter-spacing: 3px; text-shadow: 0 0 5px var(--main); font-weight: bold; }            
                  
        .info-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }          
        .info-label { font-size: 10px; color: #888; font-weight: 700; text-transform: uppercase; }
        .info-value { font-size: 11px; font-weight: 900; }
        
        /* Giao di·ªán Th·∫ª Vietinbank */
        .bank-card { background: linear-gradient(135deg, #003366 0%, #0066cc 100%); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; padding: 20px; margin-bottom: 20px; position: relative; overflow: hidden; }
        .bank-card::after { content: ""; position: absolute; top: -50%; right: -20%; width: 200px; height: 200px; background: rgba(255,255,255,0.05); border-radius: 50%; }
    </style>              
</head>              
<body>              
            
<div id="transition-screen" class="transition-overlay">            
    <div class="radar-scan"></div>            
    <div id="matrix-status" class="matrix-text">ƒêANG K·∫æT N·ªêI...</div>            
</div>            
              
<canvas id="bg-canvas"></canvas>              
<canvas id="fireworks"></canvas>              
              
<div id="success-screen" class="success-overlay">              
    <div id="loading-part" class="flex flex-col items-center">              
        <div class="w-12 h-12 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin"></div>              
        <p class="mt-4 text-[10px] font-bold tracking-widest text-cyan-400">ƒêANG X·ª¨ L√ù D·ªÆ LI·ªÜU...</p>              
        <div class="loader-bar"><div id="progress-line" class="loader-progress"></div></div>              
    </div>              
    <div id="check-part" class="hidden flex flex-col items-center">              
        <div class="w-20 h-20 bg-cyan-400 rounded-full flex items-center justify-center animate__animated animate__zoomIn">              
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="4"><polyline points="20 6 9 17 4 12"></polyline></svg>              
        </div>              
        <h2 id="success-text" class="mt-6 text-lg font-bold text-white uppercase"></h2>              
    </div>              
</div>              
              
<div id="buy-confirm-modal" class="buy-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:2000; align-items:center; justify-content:center; padding:20px;">              
    <div class="glass-card w-full max-w-[320px] p-8 text-center animate__animated animate__zoomIn">              
        <h3 class="text-xs font-bold text-gray-400 uppercase mb-2">X√ÅC NH·∫¨N THANH TO√ÅN</h3>              
        <p id="confirm-pkg-name" class="text-xl font-black text-white uppercase mb-1"></p>              
        <p id="confirm-pkg-price" class="text-cyan-400 font-bold mb-6"></p>              
        <div class="flex gap-3">              
            <button onclick="closeBuyModal()" class="flex-1 py-3 bg-white/5 rounded-xl text-[10px] font-bold uppercase">H·ªßy b·ªè</button>              
            <button id="final-buy-btn" class="flex-1 py-3 btn-main rounded-xl text-[10px] uppercase">X√°c nh·∫≠n</button>              
        </div>              
    </div>              
</div>              
              
<div class="flex items-center justify-center min-h-screen p-4 pb-28">              
    <div class="w-full max-w-[400px]">              
                      
        <div id="box-login" class="glass-card p-8 animate__animated animate__fadeIn">              
            <div class="text-center mb-8">              
                <h1 class="text-2xl font-black uppercase tracking-tighter">TOOL T√ÄI X·ªàU <span class="text-cyan-400">MD5</span></h1>              
                <p class="text-[9px] text-gray-500 font-bold uppercase mt-1">H·ªá th·ªëng Ph√¢n T√≠ch chuy√™n nghi·ªáp</p>              
            </div>              
            <div class="space-y-4">              
                <input id="u" type="text" placeholder="T√äN ƒêƒÇNG NH·∫¨P" class="w-full p-4 cyber-input uppercase">              
                <input id="p" type="password" placeholder="M·∫¨T KH·∫®U" class="w-full p-4 cyber-input">              
                <div id="login-error" class="text-center animate__animated animate__headShake" style="display:none; color:#ff4d4d; font-size:10px; font-weight:800; text-transform:uppercase; margin-top:10px;">‚ö†Ô∏è Sai t√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u!</div>              
                <button onclick="doLogin()" class="w-full py-4 btn-main rounded-xl text-sm uppercase">ƒêƒÉng nh·∫≠p ngay</button>              
                <button onclick="navigateTo('reg')" class="w-full text-[9px] text-gray-500 uppercase font-bold">T·∫°o t√†i kho·∫£n m·ªõi</button>              
            </div>              
        </div>              
              
        <div id="box-reg" class="hidden glass-card p-6 animate__animated animate__fadeIn">              
            <h2 class="text-center font-bold text-cyan-400 mb-4 uppercase text-sm">ƒêƒÉng k√Ω th√†nh vi√™n</h2>              
            <div class="space-y-3">              
                <input id="r-u" type="text" placeholder="T√äN ƒêƒÇNG NH·∫¨P" class="w-full p-3 cyber-input uppercase">              
                <input id="r-p" type="password" placeholder="M·∫¨T KH·∫®U" class="w-full p-3 cyber-input">              
                <input id="r-email" type="email" placeholder="GMAIL" class="w-full p-3 cyber-input">              
                <input id="r-phone" type="tel" placeholder="S·ªê ƒêI·ªÜN THO·∫†I" class="w-full p-3 cyber-input">              
                <div class="flex items-start gap-2 py-2">              
                    <input type="checkbox" id="tos-check" class="mt-1 accent-cyan-400">              
                    <label for="tos-check" class="text-[9px] text-gray-400 leading-tight">T√¥i ƒë·ªìng √Ω v·ªõi c√°c ƒëi·ªÅu kho·∫£n s·ª≠ d·ª•ng v√† ch√≠nh s√°ch b·∫£o m·∫≠t.</label>              
                </div>              
                <button onclick="doReg()" class="w-full py-4 btn-main rounded-xl text-sm uppercase">X√°c nh·∫≠n ƒëƒÉng k√Ω</button>              
                <button onclick="navigateTo('login')" class="w-full text-[10px] text-gray-500 uppercase mt-2">Quay l·∫°i</button>              
            </div>              
        </div>              
              
        <div id="box-portal" class="hidden animate__animated animate__zoomIn">              
            <div class="flex justify-between items-center mb-4 px-2">              
                <div class="flex items-center gap-3">              
                    <img src="https://i.imgur.com/WLeaCev.jpeg" class="avatar-img">              
                    <div>              
                        <p id="portal-user" class="text-cyan-400 text-[10px] font-bold uppercase"></p>              
                        <p id="portal-bal" class="text-xl font-black text-white">0 ƒë</p>              
                    </div>              
                </div>              
                <button onclick="navigateTo('nap')" class="bg-cyan-500/10 border border-cyan-500/50 px-4 py-2 rounded-xl text-[10px] font-bold text-cyan-400 uppercase">N·∫°p Ti·ªÅn</button>
            </div>              
            
            <div class="grid grid-cols-2 gap-3 mb-4">              
                <div onclick="navigateTo('buy-key')" class="glass-card p-6 text-center cursor-pointer border-white/5">              
                    <p class="text-2xl mb-1">üíé</p><p class="text-[10px] font-bold uppercase">G√≥i Key VIP</p>              
                </div>              
                <div onclick="navigateTo('info')" class="glass-card p-6 text-center cursor-pointer border-white/5">              
                    <p class="text-2xl mb-1">üë§</p><p class="text-[10px] font-bold uppercase">C√° Nh√¢n</p>              
                </div>              
            </div>

            <div class="glass-card p-4 bg-white/5 border-dashed border-white/10">
                <p class="text-[8px] text-gray-500 font-bold uppercase mb-2">Th√¥ng b√°o h·ªá th·ªëng</p>
                <p class="text-[10px] text-white/70 leading-relaxed italic">H·ªá th·ªëng ƒë√£ c·∫≠p nh·∫≠t th√™m g√≥i VIP 30 ng√†y v√† c·ªïng thanh to√°n VietinBank. Ch√∫c c√°c b·∫°n may m·∫Øn!</p>
            </div>
        </div>              
              
        <div id="box-buy-key" class="hidden glass-card p-5 animate__animated animate__fadeInUp">              
            <h3 class="text-center font-bold text-cyan-400 mb-4 uppercase text-xs">C·ª≠a h√†ng G√≥i Key Elite</h3>              
            <div class="space-y-2 max-h-[380px] overflow-y-auto pr-1">              
                <div onclick="confirmBuy(10000, 0.04, 'Trial')" class="pkg-item glass-card flex justify-between p-4 rounded-xl cursor-pointer">              
                    <p class="text-[11px] font-bold uppercase">D√πng Th·ª≠ (1 Gi·ªù)</p>              
                    <p class="text-gray-400 font-black text-xs">10k</p>              
                </div>              
                <div onclick="confirmBuy(25000, 1, 'Standard')" class="pkg-item glass-card flex justify-between p-4 rounded-xl cursor-pointer">              
                    <p class="text-[11px] font-bold uppercase">G√≥i Ng√†y (24 Gi·ªù)</p>              
                    <p class="text-green-400 font-black text-xs">25k</p>              
                </div>              
                <div onclick="confirmBuy(1000, 7, 'Week')" class="pkg-item pkg-silver glass-card flex justify-between p-4 rounded-xl cursor-pointer">              
                    <p class="text-[11px] font-bold uppercase">G√≥i Tu·∫ßn (7 Ng√†y)</p>              
                    <p class="text-cyan-400 font-black text-xs">100k</p>              
                </div>
                <div onclick="confirmBuy(150000, 30, 'Month')" class="pkg-item pkg-gold glass-card flex justify-between p-4 rounded-xl cursor-pointer" style="border-left: 4px solid #fbbf24;">              
                    <p class="text-[11px] font-bold uppercase text-yellow-400">G√≥i Th√°ng (30 Ng√†y)</p>              
                    <p class="text-yellow-400 font-black text-xs">150k</p>              
                </div>              
                <div onclick="confirmBuy(300000, 9999, 'Eternal')" class="pkg-item pkg-diamond glass-card flex justify-between p-4 rounded-xl cursor-pointer">              
                    <p class="text-[11px] font-bold text-red-500 uppercase">Eternal (Vƒ©nh vi·ªÖn)</p>              
                    <p class="text-white font-black text-xs">300k</p>              
                </div>              
            </div>              
            <button onclick="navigateTo('portal')" class="w-full mt-4 py-3 bg-white/5 rounded-xl text-[10px] font-bold uppercase">Quay l·∫°i trang ch·ªß</button>
        </div>              
              
        <div id="box-nap" class="hidden glass-card p-6 animate__animated animate__fadeIn">              
            <h3 class="text-center text-cyan-400 font-bold mb-6 uppercase text-sm">C·ªïng Thanh To√°n QRPAY</h3>              
            
            <div class="bank-card">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <p class="text-[8px] text-gray-400 uppercase font-bold">Ng√¢n h√†ng th·ª• h∆∞·ªüng</p>
                        <p class="text-sm font-black text-white">VIETINBANK</p>
                    </div>
                    <img src="https://img.vietqr.io/image/vietinbank-logo.png" class="h-6">
                </div>
                <div class="mb-4">
                    <p class="text-[8px] text-gray-400 uppercase font-bold">S·ªë t√†i kho·∫£n</p>
                    <p id="stk-val" class="text-xl font-black text-cyan-400 tracking-widest">103886058569</p>
                </div>
                <div>
                    <p class="text-[8px] text-gray-400 uppercase font-bold">Ch·ªß t√†i kho·∫£n</p>
                    <p class="text-xs font-bold text-white uppercase">HE THONG PHAN TICH MD5</p>
                </div>
            </div>

            <div class="text-center mb-6">
                <p class="text-[9px] text-gray-500 uppercase font-bold mb-2">Qu√©t m√£ QR ƒë·ªÉ thanh to√°n nhanh</p>
                <img id="qr-code" src="" class="mx-auto rounded-2xl w-48 border-4 border-white/10 bg-white p-2">              
            </div>

            <div class="bg-black/40 p-4 rounded-2xl mb-6 border border-cyan-500/20">              
                <p class="text-[8px] text-gray-500 uppercase font-bold mb-1">N·ªôi dung chuy·ªÉn kho·∫£n (B·∫Øt bu·ªôc)</p>              
                <p id="ref-id" class="text-lg font-black text-white tracking-widest text-center"></p>              
            </div>              
            
            <div class="space-y-3">
                <input id="nap-amount" type="number" placeholder="Nh·∫≠p s·ªë ti·ªÅn ƒë√£ chuy·ªÉn" class="w-full p-4 cyber-input">              
                <button onclick="sendNapTele()" class="w-full py-4 btn-main rounded-xl text-[11px] font-black uppercase">X√°c nh·∫≠n ƒë√£ chuy·ªÉn ti·ªÅn</button>              
                <button onclick="navigateTo('portal')" class="w-full py-3 text-[10px] text-gray-500 font-bold uppercase">H·ªßy b·ªè</button>
            </div>
        </div>              
              
        <div id="box-info" class="hidden glass-card p-6 animate__animated animate__fadeIn">          
            <div class="flex flex-col items-center mb-6">
                <img src="https://i.imgur.com/WLeaCev.jpeg" class="w-20 h-20 rounded-2xl border-2 border-cyan-400 mb-3">
                <h3 id="info-u-head" class="font-black text-white uppercase tracking-widest"></h3>
                <p class="text-[9px] text-cyan-400 font-bold uppercase">Th√†nh vi√™n Premium</p>
            </div>
            <div class="space-y-1 mb-6">          
                <div class="info-row"><span class="info-label">S·ªë ƒêi·ªán Tho·∫°i:</span><span id="info-phone" class="info-value"></span></div>          
                <div class="info-row"><span class="info-label">Gmail:</span><span id="info-email" class="info-value"></span></div>          
                <div class="info-row"><span class="info-label">S·ªë D∆∞:</span><span id="info-bal" class="info-value text-cyan-400">0ƒë</span></div>          
                <div class="info-row"><span class="info-label">H·∫°n D√πng Tool:</span><span id="info-hsd" class="info-value text-yellow-400">H·∫øt h·∫°n</span></div>          
            </div>          
            <button onclick="navigateTo('portal')" class="w-full py-3 bg-white/5 rounded-xl text-[10px] font-bold uppercase">Quay l·∫°i</button>          
        </div>          
          
        <div id="box-use-key" class="hidden glass-card p-6 animate__animated animate__fadeInUp">              
            <div id="key-activation">              
                <h3 class="text-center font-bold text-cyan-400 mb-6 uppercase text-sm">M·ªü Kh√≥a H·ªá Th·ªëng</h3>              
                <input id="key-input" type="text" placeholder="D√ÅN KEY VIP C·ª¶A B·∫†N" class="w-full p-5 cyber-input mb-4 uppercase">              
                <button onclick="activateLicense()" class="w-full py-5 btn-main rounded-2xl text-sm uppercase">K√≠ch ho·∫°t ngay</button>              
            </div>              
            <div id="tool-interface" class="hidden space-y-4">              
                <div class="flex justify-between items-center text-[8px] font-bold bg-white/5 p-3 rounded-xl border border-white/5">              
                    <span class="text-green-500">M√ÅY CH·ª¶: üü¢ ONLINE</span>              
                    <span id="expiry-text" class="text-cyan-400"></span>              
                </div>              
                <textarea id="md5-input" placeholder="D√ÅN M√É PHI√äN MD5 V√ÄO ƒê√ÇY..." class="w-full h-28 p-4 cyber-input uppercase text-[12px] font-bold"></textarea>              
                <button id="ana-btn" onclick="runAnalysis()" class="w-full py-5 btn-main rounded-2xl text-[12px] uppercase tracking-widest">B·∫ÆT ƒê·∫¶U PH√ÇN T√çCH</button>              
                <div id="res-display" class="hidden animate__animated animate__fadeIn">              
                    <div class="text-center">              
                        <span id="res-acc" class="text-[10px] font-black uppercase text-cyan-400"></span>              
                        <p id="res-val" class="font-black text-7xl italic py-2 tracking-tighter"></p>              
                        <div class="h-1 w-full bg-gradient-to-r from-transparent via-cyan-500/50 to-transparent my-2"></div>  
                        <span class="text-[7px] text-green-500 font-bold tracking-[2px] uppercase">MD5 ƒêANG HO·∫†T ƒê·ªòNG</span>  
                    </div>              
                    <div class="session-log mt-4">              
                        <div id="session-history-list"></div>              
                    </div>              
                </div>              
            </div>              
        </div>              
    </div>              
</div>              
              
<div id="main-nav" class="nav-bar hidden">              
    <div class="nav-item active" id="nav-home" onclick="navigateTo('portal'); setActiveNav(this)">              
        <svg fill="currentColor" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>              
        <span>Trang Ch·ªß</span>              
    </div>              
    <div class="nav-center" onclick="checkToolAccess(); setActiveNav(this)">              
        <svg viewBox="0 0 24 24"><path d="M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>              
    </div>              
    <div class="nav-item" id="nav-info" onclick="navigateTo('info'); setActiveNav(this)">              
        <svg fill="currentColor" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4-4 4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>              
        <span>Th√¥ng Tin</span>              
    </div>              
</div>              
              
<script>              
    var CONFIG = {              
        TELE_TOKEN: "8537007585:AAE5Z1aX4ZCMxCySB5I_qNpzhQS6sr84SsU",              
        TELE_CHAT_ID: "8144161968",              
        STK: "103886058569",              
        BANK: "CTG", // Vietinbank               
        DB_NAME: "MD5_DATABASE_PRO_V6_8"              
    };              
              
    var currentUser = null;              
    var lastUpdateId = 0;              
              
    var getDB = function() {          
        var data = localStorage.getItem(CONFIG.DB_NAME);          
        return data ? JSON.parse(data) : { users: [], keys: [], history: [] };          
    };          
    var saveDB = function(db) { localStorage.setItem(CONFIG.DB_NAME, JSON.stringify(db)); };              
              
    function navigateTo(boxId) {            
        var ts = document.getElementById('transition-screen');            
        var ms = document.getElementById('matrix-status');            
        ts.style.display = 'flex';            
        var steps = ["K·∫æT N·ªêI...", "ƒê·ªíNG B·ªò...", "HO√ÄN T·∫§T"];            
        var i = 0;            
        var interval = setInterval(function() {            
            ms.innerText = steps[i];            
            i++;            
            if(i >= steps.length) {            
                clearInterval(interval);            
                setTimeout(function() { ts.style.display = 'none'; changeBox(boxId); }, 400);            
            }            
        }, 300);            
    }            
              
    async function listenTelegram() {              
        try {              
            var res = await fetch("https://api.telegram.org/bot" + CONFIG.TELE_TOKEN + "/getUpdates?offset=" + (lastUpdateId + 1));              
            var data = await res.json();              
            if (data.ok && data.result.length > 0) {              
                data.result.forEach(function(update) {              
                    lastUpdateId = update.update_id;              
                    var msg = update.message;              
                    if (msg && msg.text && String(msg.chat.id) === CONFIG.TELE_CHAT_ID) {              
                        var parts = msg.text.trim().split(/\s+/);              
                        if (parts[0].toUpperCase() === 'DUYET' && parts.length === 3) processAutoDeposit(parts[1], parseInt(parts[2]));              
                    }              
                });              
            }              
        } catch (e) {}              
    }              
              
    function processAutoDeposit(refCode, amount) {              
        var db = getDB();              
        var uIdx = -1;          
        for(var i=0; i<db.users.length; i++) {          
            if(db.users[i].ref.toUpperCase() === refCode.toUpperCase()) { uIdx = i; break; }          
        }          
        if (uIdx !== -1) {              
            db.users[uIdx].bal += amount;              
            saveDB(db);              
            if (currentUser && currentUser.ref.toUpperCase() === refCode.toUpperCase()) {              
                currentUser = db.users[uIdx];              
                sessionStorage.setItem('activeUser', JSON.stringify(currentUser));              
                refreshPortal();              
                showSuccess("N·∫†P TH√ÄNH C√îNG +" + amount.toLocaleString() + "ƒë");              
            }              
        }              
    }              
              
    window.onload = function() {              
        if (sessionStorage.getItem('isLoggedIn')) {              
            var db = getDB();              
            var activeU = JSON.parse(sessionStorage.getItem('activeUser'));          
            for(var i=0; i<db.users.length; i++) {          
                if(db.users[i].u === activeU.u) { currentUser = db.users[i]; break; }          
            }          
            if(currentUser) {              
                document.getElementById('main-nav').classList.remove('hidden');              
                changeBox('portal');              
            }              
        }              
        setInterval(listenTelegram, 2000);               
        initBg();              
    };              
              
    function showSuccess(msg, cb) {              
        var s = document.getElementById('success-screen');              
        var lp = document.getElementById('loading-part');              
        var cp = document.getElementById('check-part');              
        document.getElementById('success-text').innerText = msg;              
        s.style.display = 'flex';              
        lp.classList.remove('hidden'); cp.classList.add('hidden');              
        var prog = 0;              
        var iv = setInterval(function() {              
            prog += 2; document.getElementById('progress-line').style.width = prog + '%';              
            if(prog >= 100) {              
                clearInterval(iv);              
                lp.classList.add('hidden'); cp.classList.remove('hidden');              
                startFireworks();              
                setTimeout(function() { s.style.display = 'none'; if(cb) cb(); }, 2000);              
            }              
        }, 30);              
    }              
              
    function changeBox(id) {              
        var boxes = document.querySelectorAll('[id^="box-"]');          
        for(var i=0; i<boxes.length; i++) boxes[i].classList.add('hidden');          
        var target = document.getElementById('box-' + id);              
        if(target) target.classList.remove('hidden');              
        if(id === 'portal') refreshPortal();              
        if(id === 'info') renderInfoBox();           
        if(id === 'nap') {              
            document.getElementById('ref-id').innerText = currentUser.ref;              
            document.getElementById('qr-code').src = "https://img.vietqr.io/image/" + CONFIG.BANK + "-" + CONFIG.STK + "-compact.png?addInfo=" + currentUser.ref;              
        }              
    }              
              
    function setActiveNav(el) {              
        var items = document.querySelectorAll('.nav-item');          
        for(var i=0; i<items.length; i++) items[i].classList.remove('active');          
        if(!el.classList.contains('nav-center')) el.classList.add('active');              
    }              
              
    function doReg() {              
        var u = document.getElementById('r-u').value.trim().toUpperCase();              
        var p = document.getElementById('r-p').value;              
        if(u.length < 4) return alert("T√™n ƒëƒÉng nh·∫≠p qu√° ng·∫Øn!");              
        var db = getDB();              
        for(var i=0; i<db.users.length; i++) if(db.users[i].u === u) return alert("T√†i kho·∫£n t·ªìn t·∫°i!");          
        var newUser = { u:u, p:p, email:document.getElementById('r-email').value, phone:document.getElementById('r-phone').value, bal: 0, ref: "NAP" + Math.floor(1000 + Math.random()*8999), hsd: null };              
        db.users.push(newUser); saveDB(db);              
        showSuccess("ƒêƒÇNG K√ù TH√ÄNH C√îNG", function() {              
            currentUser = newUser;              
            sessionStorage.setItem('isLoggedIn', 'true');              
            sessionStorage.setItem('activeUser', JSON.stringify(newUser));              
            document.getElementById('main-nav').classList.remove('hidden');              
            navigateTo('portal');              
        });              
    }              
              
    function doLogin() {              
        var u = document.getElementById('u').value.trim().toUpperCase();              
        var p = document.getElementById('p').value;              
        var db = getDB();              
        var f = null;          
        for(var i=0; i<db.users.length; i++) if(db.users[i].u === u && db.users[i].p === p) f = db.users[i];          
        if(f) {              
            currentUser = f;              
            sessionStorage.setItem('isLoggedIn', 'true');              
            sessionStorage.setItem('activeUser', JSON.stringify(f));              
            document.getElementById('main-nav').classList.remove('hidden');              
            showSuccess("ƒêƒÇNG NH·∫¨P TH√ÄNH C√îNG", function() { navigateTo('portal'); });              
        } else {              
            document.getElementById('login-error').style.display = 'block';              
        }              
    }              
              
    function refreshPortal() {              
        var db = getDB();              
        for(var i=0; i<db.users.length; i++) if(db.users[i].u === currentUser.u) currentUser = db.users[i];          
        document.getElementById('portal-user').innerText = "HI, " + currentUser.u;              
        document.getElementById('portal-bal').innerText = currentUser.bal.toLocaleString() + " ƒë";              
    }          
          
    function renderInfoBox() {          
        document.getElementById('info-u-head').innerText = currentUser.u;
        document.getElementById('info-phone').innerText = currentUser.phone || "---";          
        document.getElementById('info-email').innerText = currentUser.email || "---";          
        document.getElementById('info-bal').innerText = currentUser.bal.toLocaleString() + "ƒë";          
        document.getElementById('info-hsd').innerText = (currentUser.hsd && currentUser.hsd > Date.now()) ? (currentUser.hsd > 2000000000000 ? "Vƒ®NH VI·ªÑN" : new Date(currentUser.hsd).toLocaleDateString()) : "Ch∆∞a k√≠ch ho·∫°t";          
    }          
              
    function confirmBuy(price, days, name) {              
        var modal = document.getElementById('buy-confirm-modal');              
        document.getElementById('confirm-pkg-name').innerText = "G√≥i " + name;              
        document.getElementById('confirm-pkg-price').innerText = price.toLocaleString() + " VNƒê";              
        modal.style.display = 'flex';              
        document.getElementById('final-buy-btn').onclick = function() {              
            modal.style.display = 'none';              
            buyKey(price, days, name);          
        };              
    }              
              
    function closeBuyModal() { document.getElementById('buy-confirm-modal').style.display = 'none'; }              
              
    function buyKey(price, days, name) {              
        var db = getDB();              
        var uIdx = -1;          
        for(var i=0; i<db.users.length; i++) if(db.users[i].u === currentUser.u) uIdx = i;          
        if(db.users[uIdx].bal < price) return alert("Kh√¥ng ƒë·ªß s·ªë d∆∞!");              
        db.users[uIdx].bal -= price;              
        var key = "VIP-" + Math.random().toString(36).substring(5).toUpperCase();              
        db.keys.push({ key: key, days: days, used: false });              
        saveDB(db);              
        showSuccess("MUA KEY TH√ÄNH C√îNG", function() { prompt("L∆ØU KEY C·ª¶A B·∫†N:", key); refreshPortal(); });              
    }              
              
    function checkToolAccess() {              
        refreshPortal(); navigateTo('use-key');              
        if(currentUser.hsd && currentUser.hsd > Date.now()) {              
            document.getElementById('key-activation').classList.add('hidden');              
            document.getElementById('tool-interface').classList.remove('hidden');              
            document.getElementById('expiry-text').innerText = "HSD: " + new Date(currentUser.hsd).toLocaleDateString();              
            renderHistory();              
        } else {              
            document.getElementById('key-activation').classList.remove('hidden');              
            document.getElementById('tool-interface').classList.add('hidden');              
        }              
    }              
              
    function activateLicense() {              
        var kv = document.getElementById('key-input').value.trim().toUpperCase();              
        var db = getDB();              
        var kIdx = -1;          
        for(var i=0; i<db.keys.length; i++) if(db.keys[i].key === kv && !db.keys[i].used) kIdx = i;          
        if(kIdx === -1) return alert("Key sai ho·∫∑c ƒë√£ d√πng!");              
        var uIdx = -1;          
        for(var j=0; j<db.users.length; j++) if(db.users[j].u === currentUser.u) uIdx = j;          
        db.users[uIdx].hsd = (db.users[uIdx].hsd > Date.now() ? db.users[uIdx].hsd : Date.now()) + (db.keys[kIdx].days * 86400000);              
        db.keys[kIdx].used = true;              
        saveDB(db);              
        showSuccess("K√çCH HO·∫†T VIP", function() { checkToolAccess(); });              
    }              
              
    function runAnalysis() {              
        var input = document.getElementById('md5-input').value.trim();              
        if(input.length < 5) return alert("Nh·∫≠p m√£ MD5!");              
        var btn = document.getElementById('ana-btn');              
        btn.innerText = "ƒêANG PH√ÇN T√çCH..."; btn.disabled = true;              
              
        setTimeout(function() {              
            const raw = input.toLowerCase();  
            let score = 0;  
            for(let i=0; i<raw.length; i++) score += raw.charCodeAt(i);  
            const isTai = (score + new Date().getSeconds()) % 2 === 0;              
            var accuracy = (94 + Math.random()*5).toFixed(2);              
            var v = document.getElementById('res-val');              
            v.innerText = isTai ? "T√ÄI" : "X·ªàU";              
            v.className = "font-black text-7xl italic py-2 " + (isTai ? 'text-cyan-400' : 'text-red-500');              
            document.getElementById('res-acc').innerText = `ƒê·ªò CH√çNH X√ÅC: ${accuracy}%`;              
            document.getElementById('res-display').classList.remove('hidden');              
            var db = getDB();              
            db.history.unshift({ md5: input.substring(0, 10), res: isTai ? "T√ÄI" : "X·ªàU", acc: accuracy + "%", time: new Date().toLocaleTimeString() });              
            if(db.history.length > 5) db.history.pop();              
            saveDB(db); renderHistory(); startFireworks();              
            btn.innerText = "TI·∫æP T·ª§C"; btn.disabled = false;              
        }, 2000);              
    }              
              
    function renderHistory() {              
        var db = getDB();              
        var list = document.getElementById('session-history-list');              
        var html = '';          
        for(var i=0; i<db.history.length; i++) {          
            var item = db.history[i];          
            html += `<div class="session-item"><span>${item.md5}...</span><span class="${item.res === 'T√ÄI' ? 'text-cyan-400' : 'text-red-500'} font-black">${item.res}</span><span>${item.time}</span></div>`;          
        }          
        list.innerHTML = html;          
    }              
              
    async function sendNapTele() {              
        var amt = document.getElementById('nap-amount').value;              
        if(!amt || amt < 10000) return alert("T·ªëi thi·ªÉu 10k");              
        var text = `üí∞ Y√äU C·∫¶U N·∫†P\nüë§ User: ${currentUser.u}\nüÜî M√£: ${currentUser.ref}\nüíµ Ti·ªÅn: ${parseInt(amt).toLocaleString()}\n\nDUYET ${currentUser.ref} ${amt}`;              
        await fetch(`https://api.telegram.org/bot${CONFIG.TELE_TOKEN}/sendMessage?chat_id=${CONFIG.TELE_CHAT_ID}&text=${encodeURIComponent(text)}`);              
        alert("ƒê√£ g·ª≠i y√™u c·∫ßu! Vui l√≤ng ch·ªù.");              
    }              
              
    function startFireworks() {            
        var canvas = document.getElementById('fireworks'); var ctx = canvas.getContext('2d');            
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;            
        var particles = [];   
        function Particle(x, y, color) { this.x = x; this.y = y; this.color = color; this.angle = Math.random() * Math.PI * 2; this.speed = Math.random() * 5 + 2; this.alpha = 1; this.decay = Math.random() * 0.02 + 0.02; }            
        Particle.prototype.update = function() { this.x += Math.cos(this.angle) * this.speed; this.y += Math.sin(this.angle) * this.speed; this.alpha -= this.decay; };            
        Particle.prototype.draw = function() { ctx.globalAlpha = this.alpha; ctx.fillStyle = this.color; ctx.beginPath(); ctx.arc(this.x, this.y, 2, 0, Math.PI * 2); ctx.fill(); };            
        for (var i = 0; i < 40; i++) particles.push(new Particle(canvas.width/2, canvas.height/2, '#00f2ff'));            
        function loop() { ctx.clearRect(0, 0, canvas.width, canvas.height); for(var i=particles.length-1; i>=0; i--) { particles[i].update(); particles[i].draw(); if(particles[i].alpha <= 0) particles.splice(i, 1); } if (particles.length > 0) requestAnimationFrame(loop); }            
        loop();            
    }              
              
    function initBg() {              
        var canvas = document.getElementById('bg-canvas'); var ctx = canvas.getContext('2d');              
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;              
        var particles = [];              
        for(var i=0; i<40; i++) particles.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, r:Math.random()*2, s:Math.random()*0.5});              
        function draw() { ctx.clearRect(0,0,canvas.width,canvas.height); ctx.fillStyle = "rgba(0, 242, 255, 0.3)"; particles.forEach(p => { ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI*2); ctx.fill(); p.y -= p.s; if(p.y < -10) p.y = canvas.height + 10; }); requestAnimationFrame(draw); }              
        draw();              
    }              
</script>              
</body>              
</html>
