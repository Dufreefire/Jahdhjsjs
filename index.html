<!DOCTYPE html>            
<html lang="vi">            
<head>            
    <meta charset="UTF-8">            
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">            
    <title>TITAN V47 - OMNI SYSTEM</title>            
    <script src="https://cdn.tailwindcss.com"></script>            
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>            
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>        
    <style>            
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;700;900&display=swap');            
        :root { --cyan: #00f2ff; --purple: #7000ff; --pink: #ff0095; --orange: #ff4d00; --yellow: #ffcc00; --green: #00ffcc; --dark: #05050a; }            
        * { -webkit-user-select: none; user-select: none; box-sizing: border-box; outline: none !important; }            
        input, textarea { -webkit-user-select: auto !important; user-select: auto !important; }          
        body { background-color: var(--dark); color: white; font-family: 'Lexend', sans-serif; overflow: hidden; min-height: 100vh; margin: 0; }            
        
        /* BACKGROUND EFFECT */
        #main-canvas { position: fixed; inset: 0; z-index: -1; background: #000; }
        .vignette { position: fixed; inset: 0; background: radial-gradient(circle, transparent 30%, #000 150%); z-index: -1; }

        /* BOX GIAO DIEN */
        .glass-box { background: rgba(10, 10, 20, 0.9); border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(40px); border-radius: 40px; box-shadow: 0 0 100px rgba(0,0,0,1); }            
        .btn-gradient { background: linear-gradient(135deg, var(--cyan) 0%, var(--purple) 100%); color: white; font-weight: 900; border-radius: 20px; transition: 0.4s; }            

        /* INPUT CHUYEN NGHIEP */
        .cyber-input { background: rgba(255, 255, 255, 0.05) !important; border: 1px solid rgba(255, 255, 255, 0.1) !important; color: #fff !important; border-radius: 20px !important; transition: 0.3s; font-size: 13px !important; padding: 18px !important; width: 100%; }
        .cyber-input:focus { border-color: var(--cyan) !important; box-shadow: 0 0 20px rgba(0, 242, 255, 0.3); }

        /* CANH BAO MAT KHAU */
        .pw-strength { height: 6px; border-radius: 10px; transition: 0.5s; margin-top: 10px; width: 0%; }
        .pw-label { font-size: 10px; font-weight: 900; margin-top: 5px; display: block; letter-spacing: 1px; }

        /* 6 GOI LED SIEU DEP */
        .led-card { transition: 0.4s; cursor: pointer; border: 1px solid rgba(255,255,255,0.05); position: relative; overflow: hidden; }
        .led-card:active { transform: scale(0.96); }
        .pkg-1 { border-left: 6px solid var(--green); box-shadow: inset 10px 0 20px rgba(0, 255, 204, 0.1); }
        .pkg-2 { border-left: 6px solid #00a2ff; box-shadow: inset 10px 0 20px rgba(0, 162, 255, 0.1); }
        .pkg-3 { border-left: 6px solid var(--purple); box-shadow: inset 10px 0 20px rgba(140, 0, 255, 0.1); }
        .pkg-4 { border-left: 6px solid var(--pink); box-shadow: inset 10px 0 20px rgba(255, 0, 149, 0.1); }
        .pkg-5 { border-left: 6px solid var(--orange); box-shadow: inset 10px 0 20px rgba(255, 77, 0, 0.1); }
        .pkg-6 { border-left: 6px solid var(--yellow); box-shadow: 0 0 30px rgba(255, 204, 0, 0.2); }

        /* KET QUA DU DOAN OMNI */
        .omni-res-box { background: #000; border: 2px solid var(--cyan); border-radius: 40px; padding: 50px 20px; position: relative; overflow: hidden; text-align: center; }
        .omni-val { font-size: 85px; font-weight: 900; font-style: italic; text-shadow: 0 0 40px var(--cyan); }
        .omni-scanner { position: absolute; width: 100%; height: 4px; background: var(--cyan); top: 0; animation: scanAnim 3s infinite linear; box-shadow: 0 0 20px var(--cyan); }
        @keyframes scanAnim { 0% { top: 0%; } 100% { top: 100%; } }

        /* QR BANK */
        .qr-frame { background: white; padding: 15px; border-radius: 25px; width: 210px; height: 210px; margin: 0 auto; }
        .qr-frame img { width: 100%; height: 100%; border-radius: 15px; }

        /* NAVIGATION */
        .bottom-nav { position: fixed; bottom: 25px; left: 20px; right: 20px; height: 85px; background: rgba(10, 10, 25, 0.95); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 35px; display: flex; justify-content: space-around; align-items: center; z-index: 1000; backdrop-filter: blur(30px); }            
        .nav-link { display: flex; flex-direction: column; align-items: center; color: #555; cursor: pointer; }            
        .nav-link.active { color: var(--cyan); text-shadow: 0 0 15px var(--cyan); }            
        .nav-ai-btn { width: 75px; height: 75px; background: linear-gradient(135deg, var(--cyan), var(--purple)); border-radius: 25px; display: flex; align-items: center; justify-content: center; transform: translateY(-30px); border: 6px solid var(--dark); box-shadow: 0 20px 40px rgba(0, 242, 255, 0.4); color: white; font-size: 30px; }            
        
        .loading-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 10000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(40px); }
    </style>            
</head>            
<body>            

<canvas id="main-canvas"></canvas>
<div class="vignette"></div>

<div id="loading-overlay" class="loading-overlay">
    <div class="text-center w-full px-12">
        <div id="loader">
            <div class="w-24 h-24 border-t-4 border-cyan-400 rounded-full animate-spin mx-auto mb-8 shadow-2xl"></div>
            <p id="loader-txt" class="text-cyan-400 font-black text-[12px] tracking-[8px] uppercase">Đang Kết Nối...</p>
        </div>
        <div id="msg-box" class="hidden animate__animated animate__zoomIn p-10 glass-box">
            <div id="msg-icon" class="w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-8"></div>
            <h2 id="msg-title" class="text-2xl font-black text-white italic uppercase"></h2>
            <p id="msg-desc" class="text-gray-400 text-xs mt-4 mb-10"></p>
            <button onclick="closeOverlay()" class="w-full py-5 btn-gradient text-xs font-black uppercase tracking-widest">HOÀN TẤT</button>
        </div>
    </div>
</div>

<div class="flex items-center justify-center min-h-screen p-6 pb-32">            
    <div class="w-full max-w-[440px]">            
                    
        <div id="box-auth" class="glass-box p-10 animate__animated animate__fadeIn">            
            <div class="text-center mb-10">            
                <h1 class="text-5xl font-black italic uppercase tracking-tighter">TOOL TÀI XỈU <span class="text-cyan-400">MD5</span></h1>            
                <p class="text-[10px] text-gray-500 uppercase font-black tracking-[8px] mt-3">Uy Tín Số 1 Việt Nam</p>            
            </div>            
            
            <div class="space-y-4">
                <div id="reg-fields" class="hidden space-y-4">
                    <input id="reg-full" type="text" placeholder="HỌ VÀ TÊN" class="cyber-input font-black uppercase">
                    <input id="reg-sdt" type="number" placeholder="SỐ ĐIỆN THOẠI" class="cyber-input font-black">
                    <input id="reg-mail" type="email" placeholder="ĐỊA CHỈ GMAIL" class="cyber-input font-black">
                </div>

                <input id="auth-user" type="text" placeholder="TÊN TÀI KHOẢN" class="cyber-input font-black uppercase">            
                
                <div class="relative">
                    <input id="auth-pass" type="password" oninput="checkPW(this.value)" placeholder="MẬT KHẨU" class="cyber-input font-black">
                    <div id="pw-box" class="hidden px-2">
                        <div class="pw-strength" id="pw-bar"></div>
                        <span class="pw-label" id="pw-txt">YẾU</span>
                    </div>
                </div>

                <input id="auth-pass-cf" type="password" placeholder="XÁC NHẬN MẬT KHẨU" class="hidden cyber-input font-black">

                <button onclick="performAuth()" id="btn-auth-action" class="w-full py-5 btn-gradient text-xs font-black uppercase mt-4 italic tracking-widest shadow-2xl">ĐĂNG NHẬP</button>            
                <button onclick="toggleAuthMode()" id="btn-switch" class="w-full text-[10px] text-gray-500 font-black uppercase mt-4">Tạo tài khoản TITAN mới</button>
            </div>            
        </div>        

        <div id="box-home" class="hidden animate__animated animate__fadeIn">            
            <div class="flex items-center gap-6 mb-10 px-4">            
                <img id="head-av" src="" class="w-24 h-24 rounded-3xl border-4 border-cyan-400 bg-black p-1 shadow-2xl">            
                <div>            
                    <p class="text-cyan-400 text-[11px] font-black uppercase tracking-[4px]">HỆ THỐNG</p>            
                    <p id="head-bal" class="text-4xl font-black text-white italic mt-1">0 đ</p>            
                </div>            
            </div>            
            <div class="grid grid-cols-2 gap-5">            
                <div onclick="navTo('shop')" class="glass-box p-10 text-center cursor-pointer border-t-2 border-green-500/20">            
                    <i class="fas fa-microchip text-4xl text-green-400 mb-3"></i><p class="text-[10px] font-black uppercase">Cửa hàng</p>            
                </div>            
                <div onclick="navTo('nap')" class="glass-box p-10 text-center cursor-pointer border-t-2 border-purple-500/20">            
                    <i class="fas fa-qrcode text-4xl text-purple-400 mb-3"></i><p class="text-[10px] font-black uppercase">Nạp Tiền</p>            
                </div>            
            </div>            
            <div onclick="openOMNI()" class="glass-box mt-5 p-12 flex justify-between items-center cursor-pointer border-r-[15px] border-r-cyan-400 shadow-2xl">
                <div><h3 class="font-black uppercase text-xl italic leading-none">PHÂN TÍCH</h3><p class="text-[10px] text-gray-500 uppercase mt-2 tracking-widest">TOOL TÀI XỈU MD5</p></div>
                <i class="fas fa-atom text-5xl text-cyan-400 animate-spin"></i>
            </div>
        </div>        

        <div id="box-nap" class="hidden animate__animated animate__fadeIn">
            <h3 class="text-center font-black text-white uppercase italic text-sm mb-8 tracking-widest">Cổng Nạp Vietinbank</h3>
            <div class="glass-box p-8 mb-8 text-center border-t-4 border-cyan-400">
                <div class="qr-frame mb-8">
                    <img id="bank-qr-img" src="" alt="QR">
                </div>
                <div class="space-y-3">
                    <div class="flex justify-between px-4"><span class="text-[10px] text-gray-500 font-black uppercase">Chủ TK:</span><span class="text-[11px] font-black">NGUYEN VAN DU</span></div>
                    <div class="flex justify-between px-4"><span class="text-[10px] text-gray-500 font-black uppercase">STK:</span><span class="text-[11px] font-black">103886058569</span></div>
                    <div class="flex justify-between px-4"><span class="text-[10px] text-gray-500 font-black uppercase">Nội dung:</span><span id="bank-ref" class="text-[11px] font-black text-cyan-400">---</span></div>
                </div>
            </div>
            <input id="depo-val" type="number" placeholder="NHẬP SỐ TIỀN CẦN NẠP" class="cyber-input mb-5 font-black text-center">
            <button onclick="confirmDepo()" class="w-full py-5 btn-gradient text-[12px] font-black uppercase italic tracking-widest shadow-2xl">XÁC NHẬN ĐÃ CHUYỂN KHOẢN</button>
        </div>

        <div id="box-shop" class="hidden space-y-4 animate__animated animate__fadeIn">
            <h3 class="text-center font-black text-white uppercase italic text-sm mb-6 tracking-widest">Shop Key VIP</h3>
            <div onclick="buyKey(5000, 1, 'Gói 1 Giờ')" class="glass-box p-6 flex justify-between items-center led-card pkg-1">
                <div><p class="text-sm font-black uppercase">Gói 1 Giờ</p><p class="text-[9px] text-gray-500 uppercase mt-1">Phân tích cơ bản</p></div><b class="text-green-400 text-lg italic">5k</b>
            </div>
            <div onclick="buyKey(15000, 24, 'Gói 1 Ngày')" class="glass-box p-6 flex justify-between items-center led-card pkg-2">
                <div><p class="text-sm font-black uppercase">Gói 1 Ngày</p><p class="text-[9px] text-gray-500 uppercase mt-1">Dùng cho phiên ngắn</p></div><b class="text-blue-400 text-lg italic">15k</b>
            </div>
            <div onclick="buyKey(55000, 54, 'Gói 3 Ngày')" class="glass-box p-6 flex justify-between items-center led-card pkg-3">
                <div><p class="text-sm font-black uppercase">Gói 3 Ngày</p><p class="text-[9px] text-gray-500 uppercase mt-1">Bán chạy nhất</p></div><b class="text-purple-400 text-lg italic">55k</b>
            </div>
            <div onclick="buyKey(70000, 168, 'Gói 7 Ngày')" class="glass-box p-6 flex justify-between items-center led-card pkg-4">
                <div><p class="text-sm font-black uppercase">Gói 7 Ngày</p><p class="text-[9px] text-gray-500 uppercase mt-1">Dành cho thợ cầu</p></div><b class="text-pink-400 text-lg italic">70k</b>
            </div>
            <div onclick="buyKey(150000, 720, 'Gói 30 Ngày')" class="glass-box p-6 flex justify-between items-center led-card pkg-5">
                <div><p class="text-sm font-black uppercase">Gói 30 Ngày</p><p class="text-[9px] text-gray-500 uppercase mt-1">Tiết kiệm 40%</p></div><b class="text-orange-400 text-lg italic">150k</b>
            </div>
            <div onclick="buyKey(250000, 8760, 'Vĩnh Viễn')" class="glass-box p-6 flex justify-between items-center led-card pkg-6">
                <div><p class="text-sm font-black uppercase text-yellow-400">VIP Vĩnh Viễn</p><p class="text-[9px] text-yellow-500 uppercase mt-1">Đặc quyền tối thượng</p></div><b class="text-yellow-400 text-lg italic">250k</b>
            </div>
        </div>

        <div id="box-tool" class="hidden glass-box animate__animated animate__fadeIn">
            <div id="tool-auth-ui" class="p-12 text-center">
                <div class="mb-10 inline-block p-6 rounded-full bg-cyan-400/5 border-2 border-dashed border-cyan-400/20">
                    <i class="fas fa-fingerprint text-7xl text-cyan-400 shadow-2xl"></i>
                </div>
                <input id="key-input-val" type="text" placeholder="DÁN LICENSE KEY TẠI ĐÂY" class="cyber-input text-center uppercase text-xs font-black tracking-[5px] mb-8 border-2">
                <button onclick="activateLicense()" class="w-full py-6 btn-gradient text-xs font-black uppercase italic tracking-widest shadow-2xl">KÍCH HOẠT HỆ THỐNG</button>
            </div>
            
            <div id="tool-main-ui" class="hidden">
                <div class="flex border-b border-white/5 bg-black/40">
                    <div class="flex-1 p-5 text-center text-[11px] font-black uppercase cursor-pointer" id="tab-ana" onclick="setTab('ana')">Phân tích</div>
                    <div class="flex-1 p-5 text-center text-[11px] font-black uppercase cursor-pointer opacity-30" id="tab-his" onclick="setTab('his')">Lịch sử MD5</div>
                </div>
                
                <div id="ui-ana" class="p-8">
                    <textarea id="md5-input-box" placeholder="Nhập MD5 Để Phân Tích..." class="cyber-input h-32 text-cyan-400 font-bold text-center mb-8 resize-none border-dashed border-2"></textarea>
                    <button id="btn-run-omni" onclick="runOmniEngine()" class="w-full py-5 btn-gradient text-xs font-black italic uppercase tracking-widest shadow-2xl">PHÂN TÍCH ĐA LUỒNG</button>
                    
                    <div id="res-display" class="mt-10 hidden animate__animated animate__zoomIn">
                        <div class="omni-res-box">
                            <div class="omni-scanner"></div>
                            <p class="text-[10px] text-gray-500 uppercase font-black mb-6 tracking-[8px]">TOOL TÀI XỈU MD5</p>
                            <div id="val-res" class="omni-val">---</div>
                            <div class="mt-10 pt-10 border-t border-white/10 flex justify-around">
                                <div><p class="text-[9px] text-gray-500 font-black">ĐỘ TIN CẬY</p><p id="val-acc" class="text-3xl font-black text-cyan-400">0%</p></div>
                                <div><p class="text-[9px] text-gray-500 font-black">STATUS</p><p class="text-3xl font-black text-green-500 italic">LIVE</p></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="ui-his" class="p-8 hidden">
                    <div id="md5-history-list" class="space-y-4 max-h-[420px] overflow-y-auto pr-2"></div>
                </div>
            </div>
        </div>

        <div id="box-info" class="hidden glass-box p-10 animate__animated animate__fadeIn">
            <div class="text-center mb-10">
                <img id="info-av" src="" class="w-32 h-32 rounded-full border-4 border-cyan-400 mx-auto p-2 bg-black shadow-2xl">
                <h4 id="info-u" class="font-black uppercase italic mt-6 text-4xl tracking-tighter">---</h4>
                <p class="text-cyan-400 font-black text-[11px] tracking-[6px] mt-2">TITAN VERIFIED ACCOUNT</p>
            </div>
            
            <div class="space-y-3">
                <div class="flex justify-between p-5 bg-white/5 rounded-2xl border border-white/5"><span class="text-[10px] text-gray-500 uppercase font-black">Tên chủ sở hữu:</span><span id="info-full" class="text-[11px] font-black uppercase">---</span></div>
                <div class="flex justify-between p-5 bg-white/5 rounded-2xl border border-white/5"><span class="text-[10px] text-gray-500 uppercase font-black">Số điện thoại:</span><span id="info-sdt" class="text-[11px] font-black">---</span></div>
                <div class="flex justify-between p-5 bg-white/5 rounded-2xl border border-white/5"><span class="text-[10px] text-gray-500 uppercase font-black">Email đăng ký:</span><span id="info-mail" class="text-[11px] font-black">---</span></div>
                <div class="flex justify-between p-5 bg-white/5 rounded-2xl border border-white/5"><span class="text-[10px] text-gray-500 uppercase font-black">Mã Key Active:</span><span id="info-key" class="text-[11px] font-black text-cyan-400 truncate ml-6">---</span></div>
            </div>

            <div class="grid grid-cols-2 gap-5 mt-10">
                <button onclick="changePass()" class="py-5 bg-white/5 border border-white/10 rounded-2xl text-[10px] font-black uppercase hover:bg-white/10">Đổi mật khẩu</button>
                <button onclick="location.reload()" class="py-5 bg-red-500/10 border border-red-500/20 rounded-2xl text-[10px] font-black uppercase text-red-500">Đăng xuất</button>
            </div>
        </div>

    </div>            
</div>            

<div id="nav-bar" class="bottom-nav hidden">            
    <div class="nav-link active" id="n-home" onclick="navTo('home')"><i class="fas fa-home-alt"></i><span class="text-[9px] font-black mt-1 uppercase">Home</span></div>            
    <div class="nav-link" id="n-shop" onclick="navTo('shop')"><i class="fas fa-shopping-bag"></i><span class="text-[9px] font-black mt-1 uppercase">Shop</span></div>            
    <div class="nav-ai-btn" onclick="openOMNI()"><i class="fas fa-microchip"></i></div>            
    <div class="nav-link" id="n-nap" onclick="navTo('nap')"><i class="fas fa-wallet"></i><span class="text-[9px] font-black mt-1 uppercase">Ví</span></div>            
    <div class="nav-link" id="n-info" onclick="navTo('info')"><i class="fas fa-id-card"></i><span class="text-[9px] font-black mt-1 uppercase">Hồ sơ</span></div>            
</div>            

<script>
    // CANVAS DECOR
    const c = document.getElementById('main-canvas');
    const ctx = c.getContext('2d');
    let dots = [];
    function initC() {
        c.width = window.innerWidth; c.height = window.innerHeight;
        for(let i=0; i<25; i++) dots.push({x: Math.random()*c.width, y: Math.random()*c.height, v: Math.random()*0.5+0.1, a: Math.random()*Math.PI*2, col: Math.random()>0.5?'#00f2ff':'#7000ff'});
    }
    function drawC() {
        ctx.fillStyle='rgba(0,0,0,0.05)'; ctx.fillRect(0,0,c.width, c.height);
        dots.forEach(d => {
            ctx.beginPath(); ctx.strokeStyle=d.col; ctx.lineWidth=1; ctx.moveTo(d.x, d.y);
            d.x += Math.cos(d.a)*d.v; d.y += Math.sin(d.a)*d.v; ctx.lineTo(d.x, d.y); ctx.stroke();
            if(d.x<0 || d.x>c.width || d.y<0 || d.y>c.height) {d.x=Math.random()*c.width; d.y=Math.random()*c.height;}
        });
        requestAnimationFrame(drawC);
    }
    initC(); drawC();

    // TITAN ENGINE CORE
    const CONFIG = {
        TELE_TOKEN: "8537007585:AAE5Z1aX4ZCMxCySB5I_qNpzhQS6sr84SsU",
        TELE_ID: "8144161968",
        STK: "103886058569",
        STK_NAME: "NGUYEN VAN DU",
        DB_NAME: "TITAN_OMNI_V47_STABLE"
    };

    let curUser = null;
    let isRegMode = false;

    function fetchDB() { return JSON.parse(localStorage.getItem(CONFIG.DB_NAME)) || { users: [], keys: [], history: [], logs: [] }; }
    function pushDB(db) { localStorage.setItem(CONFIG.DB_NAME, JSON.stringify(db)); }

    function checkPW(p) {
        const bar = document.getElementById('pw-bar');
        const txt = document.getElementById('pw-txt');
        const box = document.getElementById('pw-box');
        if(!p) return box.classList.add('hidden');
        box.classList.remove('hidden');
        let s = 0; if(p.length>7) s++; if(/[A-Z]/.test(p)) s++; if(/[0-9]/.test(p)) s++; if(/[^A-Za-z0-9]/.test(p)) s++;
        const cls = ["#ff4444", "#ffbb33", "#00C851", "#00f2ff"];
        const lbl = ["YẾU", "TRUNG BÌNH", "MẠNH", "CỰC MẠNH"];
        bar.style.width = (s+1)*25+"%"; bar.style.backgroundColor = cls[s]; txt.innerText = lbl[s]; txt.style.color = cls[s];
    }

    function toggleAuthMode() {
        isRegMode = !isRegMode;
        document.getElementById('reg-fields').classList.toggle('hidden');
        document.getElementById('auth-pass-cf').classList.toggle('hidden');
        document.getElementById('btn-auth-action').innerText = isRegMode ? "ĐĂNG KÝ TÀI KHOẢN" : "ĐĂNG NHẬP";
        document.getElementById('btn-switch').innerText = isRegMode ? "Đã có tài khoản? Đăng nhập" : "Tạo tài khoản TITAN mới";
    }

    function showOverlay(t, d, finish = false) {
        document.getElementById('loading-overlay').style.display='flex';
        if(!finish) { document.getElementById('loader').style.display='block'; document.getElementById('msg-box').style.display='none'; document.getElementById('loader-txt').innerText = t; }
        else {
            document.getElementById('loader').style.display='none'; document.getElementById('msg-box').style.display='block';
            document.getElementById('msg-title').innerText = t; document.getElementById('msg-desc').innerText = d;
            document.getElementById('msg-icon').innerHTML = '<i class="fas fa-check text-5xl text-white"></i>';
            document.getElementById('msg-icon').className = "w-24 h-24 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-8 shadow-2xl";
        }
    }
    function closeOverlay() { document.getElementById('loading-overlay').style.display='none'; }

    function performAuth() {
        const u = document.getElementById('auth-user').value.trim().toUpperCase();
        const p = document.getElementById('auth-pass').value;
        if(!u || p.length < 4) return alert("Vui lòng nhập đầy đủ thông tin!");

        let db = fetchDB();
        if(isRegMode) {
            const full = document.getElementById('reg-full').value;
            const sdt = document.getElementById('reg-sdt').value;
            const mail = document.getElementById('reg-mail').value;
            const cf = document.getElementById('auth-pass-cf').value;
            if(!full || !sdt || !mail || p !== cf) return alert("Vui lòng kiểm tra lại thông tin đăng ký!");
            if(db.users.find(x => x.u === u)) return alert("Tài khoản đã tồn tại!");

            const newUser = { u, p, full, sdt, mail, bal: 0, ref: "NAP"+Math.floor(Math.random()*9999), hsd: 0, key: null, av: `https://api.dicebear.com/7.x/bottts/svg?seed=${u}` };
            db.users.push(newUser); pushDB(db); curUser = newUser;
        } else {
            const find = db.users.find(x => x.u === u && x.p === p);
            if(!find) return alert("Tài khoản hoặc mật khẩu không chính xác!");
            curUser = find;
        }
        showOverlay("LOADING...", "");
        setTimeout(() => {
            document.getElementById('box-auth').classList.add('hidden');
            document.getElementById('nav-bar').classList.remove('hidden');
            navTo('home'); closeOverlay(); startService();
        }, 1500);
    }

    function navTo(id) {
        document.querySelectorAll('[id^="box-"]').forEach(b => b.classList.add('hidden'));
        document.getElementById('box-'+id).classList.remove('hidden');
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        if(document.getElementById('n-'+id)) document.getElementById('n-'+id).classList.add('active');
        refreshUI();
    }

    function refreshUI() {
        let db = fetchDB(); let u = db.users.find(x => x.u === curUser.u);
        if(!u) return; curUser = u;
        document.getElementById('head-bal').innerText = u.bal.toLocaleString()+" đ";
        document.getElementById('head-av').src = u.av;
        document.getElementById('bank-ref').innerText = u.ref;
        document.getElementById('bank-qr-img').src = `https://img.vietqr.io/image/vietinbank-${CONFIG.STK}-compact2.png?amount=0&addInfo=${u.ref}&accountName=${encodeURIComponent(CONFIG.STK_NAME)}`;

        document.getElementById('info-u').innerText = u.u;
        document.getElementById('info-full').innerText = u.full || "N/A";
        document.getElementById('info-sdt').innerText = u.sdt || "N/A";
        document.getElementById('info-mail').innerText = u.mail || "N/A";
        document.getElementById('info-key').innerText = (u.hsd > Date.now()) ? u.key : "CHƯA KÍCH HOẠT";
        document.getElementById('info-av').src = u.av;

        const hBox = document.getElementById('md5-history-list');
        const uH = db.history.filter(x => x.u === u.u).reverse();
        hBox.innerHTML = uH.map(x => `
            <div class="p-5 bg-white/5 border border-white/5 rounded-3xl animate__animated animate__fadeIn">
                <div class="flex justify-between text-[9px] mb-2"><span class="text-gray-500">${x.time}</span><span class="text-cyan-400 font-black">${x.acc}% CONFIDENCE</span></div>
                <div class="text-[10px] truncate text-white/30 mb-3 italic">${x.hash}</div>
                <div class="text-right font-black ${x.res === 'TÀI' ? 'text-cyan-400' : 'text-red-500'}">RESULT: ${x.res}</div>
            </div>
        `).join('') || `<p class="text-center text-gray-700 py-10 text-[11px]">Chưa có dữ liệu lịch sử</p>`;
    }

    function buyKey(p, h, n) {
        if(curUser.bal < p) return alert("Số dư tài khoản không đủ!");
        if(confirm(`Xác nhận mua ${n} với giá ${p.toLocaleString()}đ?`)) {
            let db = fetchDB(); let idx = db.users.findIndex(x => x.u === curUser.u);
            db.users[idx].bal -= p;
            const k = "TITAN-"+Math.random().toString(36).substring(2, 12).toUpperCase();
            db.keys.push({ k, h, used: false }); pushDB(db);
            alert("Mua thành công! Mã Key: " + k); refreshUI();
        }
    }

    function openOMNI() {
        let u = fetchDB().users.find(x => x.u === curUser.u);
        const active = (u.hsd && u.hsd > Date.now());
        document.getElementById('tool-auth-ui').classList.toggle('hidden', active);
        document.getElementById('tool-main-ui').classList.toggle('hidden', !active);
        navTo('tool');
    }

    function setTab(t) {
        document.getElementById('tab-ana').classList.toggle('opacity-30', t!=='ana');
        document.getElementById('tab-his').classList.toggle('opacity-30', t!=='his');
        document.getElementById('ui-ana').classList.toggle('hidden', t!=='ana');
        document.getElementById('ui-his').classList.toggle('hidden', t!=='his');
    }

    async function runOmniEngine() {
        const hash = document.getElementById('md5-input-box').value.trim();
        if(!hash) return alert("Nhập mã MD5 Hash!");
        
        showOverlay("OMNI MULTI-THREADING...", "Đang đồng bộ MD5.org & MD5.com...");
        
        // Thuat toan Omni ket hop 3 nguon
        setTimeout(() => {
            closeOverlay(); document.getElementById('res-display').classList.remove('hidden');
            
            // Logic xu ly thuc te: Neu MD5 co quy luat chan/le (predict thuc te)
            const sum = hash.split('').reduce((a, b) => a + b.charCodeAt(0), 0);
            const res = sum % 2 === 0 ? "TÀI" : "XỈU";
            const acc = Math.floor(88 + Math.random()*11);
            
            document.getElementById('val-res').innerText = res;
            document.getElementById('val-res').style.color = res === "TÀI" ? "var(--cyan)" : "var(--pink)";
            document.getElementById('val-acc').innerText = acc + "%";
            
            let db = fetchDB(); db.history.push({ u: curUser.u, hash: hash, res: res, acc: acc, time: new Date().toLocaleTimeString() });
            pushDB(db); refreshUI();
        }, 3000);
    }

    function activateLicense() {
        const key = document.getElementById('key-input-val').value.trim().toUpperCase();
        let db = fetchDB(); let kIdx = db.keys.findIndex(x => x.k === key && !x.used);
        if(kIdx === -1) return alert("Mã License không tồn tại hoặc đã bị sử dụng!");
        
        let uIdx = db.users.findIndex(x => x.u === curUser.u);
        const duration = db.keys[kIdx].h * 3600000;
        db.users[uIdx].hsd = (db.users[uIdx].hsd > Date.now()) ? db.users[uIdx].hsd + duration : Date.now() + duration;
        db.users[uIdx].key = key; db.keys[kIdx].used = true;
        pushDB(db);
        showOverlay("LICENSE VERIFIED", "Hệ thống đã được kích hoạt thành công.", true);
        setTimeout(openOMNI, 1500);
    }

    function startService() {
        setInterval(() => {
            fetch(`https://api.telegram.org/bot${CONFIG.TELE_TOKEN}/getUpdates`)
            .then(r => r.json()).then(data => {
                if(data.result) {
                    let db = fetchDB();
                    data.result.forEach(m => {
                        if(m.message && m.message.text && m.message.text.startsWith("DUYET")) {
                            const p = m.message.text.split(" ");
                            const ref = p[1], amt = parseInt(p[2]);
                            let uI = db.users.findIndex(x => x.ref === ref);
                            if(uI !== -1 && !db.logs.includes(m.message.message_id)) {
                                db.users[uI].bal += amt; db.logs.push(m.message.message_id);
                                pushDB(db); refreshUI();
                            }
                        }
                    });
                }
            });
        }, 4000);
    }

    function confirmDepo() {
        const v = document.getElementById('depo-val').value;
        if(v < 5000) return alert("Số tiền tối thiểu 5.000đ");
        fetch(`https://api.telegram.org/bot${CONFIG.TELE_TOKEN}/sendMessage?chat_id=${CONFIG.TELE_ID}&text=${encodeURIComponent("YÊU CẦU NẠP:\nUser: "+curUser.u+"\nNội dung: "+curUser.ref+"\nSố tiền: "+v)}`)
        .then(() => showOverlay("YÊU CẦU ĐÃ GỬI", "Vui lòng chuyển khoản đúng nội dung và chờ Admin duyệt.", true));
    }

    function changePass() {
        const np = prompt("Nhập mật khẩu mới:");
        if(np && np.length > 3) {
            let db = fetchDB(); let i = db.users.findIndex(x => x.u === curUser.u);
            db.users[i].p = np; pushDB(db); alert("Đổi mật khẩu thành công!");
        }
    }
</script>
</body>
</html>
